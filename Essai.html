<html>
  <head>
    <meta charset="UTF-8" />
  </head>

  <body>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-org-chart@2"></script>
    <script src="https://raw.githubusercontent.com/sassent/essai/main/d3-flextree.js"></script>
    <div
      class="chart-container"
      style="height: 1200px; background-color: #f6f6f6"
    ></div>

    <script>
      var chart;
      d3.csv(
        'https://raw.githubusercontent.com/sassent/essai/main/dataANONYME.csv'
      ).then((dataFlattened) => {
        chart = new d3.OrgChart()
          .container('.chart-container')
          .data(dataFlattened)
          .nodeWidth((d) => 250)
          .initialZoom(0.7)
          .nodeHeight((d) => 175)
          .childrenMargin((d) => 40)
          .compactMarginBetween((d) => 15)
          .compactMarginPair((d) => 80)
          .nodeContent(function (d, i, arr, state) {
            return `
            <div style="padding-top:30px;background-color:none;margin-left:1px;height:${
              d.height
            }px;border-radius:2px;overflow:visible">
              <div style="height:${
                d.height - 32
              }px;padding-top:0px;background-color:white;border:1px solid lightgray;">

                <img src=" ${
                  d.data.imageUrl
                }" style="margin-top:-30px;margin-left:${d.width / 2 - 30}px;border-radius:100px;width:60px;height:60px;" />

               <div style="margin-right:10px;margin-top:15px;float:right">${
                 d.data.id
               }</div>
               
               <div style="margin-top:-30px;background-color:#3AB6E3;height:10px;width:${
                 d.width - 2
               }px;border-radius:1px"></div>

               <div style="padding:20px; padding-top:35px;text-align:center">
                   <div style="color:#111672;font-size:16px;font-weight:bold"> ${
                     d.data.name
                   } </div>
                   <div style="color:#404040;font-size:16px;margin-top:4px"> ${
                     d.data.positionName
                   } </div>
               </div> 
               <div style="display:flex;justify-content:space-between;padding-left:15px;padding-right:15px;">
                 <div > ${d.data.office} </div>  
                 <div > ${d.data.area} </div>    
               </div>
              </div>     
      </div>
      
  `;
          })
          .render();
      });
    </script>
  </body>
  <script src="https://storage.ko-fi.com/cdn/scripts/overlay-widget.js"></script>

  <style>
    .btn {
      margin: 3px;
      color: inherit;
      text-transform: uppercase;
      word-wrap: break-word;
      white-space: normal;
      cursor: pointer;
      border: 0;
      border-radius: 0.125rem;
      -webkit-box-shadow: 0 2px 5px 0 rgb(0 0 0 / 16%),
        0 2px 10px 0 rgb(0 0 0 / 12%);
      box-shadow: 0 2px 5px 0 rgb(0 0 0 / 16%), 0 2px 10px 0 rgb(0 0 0 / 12%);
      -webkit-transition: color 0.15s ease-in-out,
        background-color 0.15s ease-in-out, border-color 0.15s ease-in-out,
        -webkit-box-shadow 0.15s ease-in-out;
      transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out,
        border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out;
      transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out,
        border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
      transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out,
        border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out,
        -webkit-box-shadow 0.15s ease-in-out;
      padding: 0.84rem 2.14rem;
      font-size: 0.81rem;
      display: inline-block;
      font-weight: 400;
      color: #212529;
      text-align: center;
      vertical-align: middle;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      border: 1px solid transparent;
      padding: 0.375rem 0.75rem;
      font-size: 1rem;
      line-height: 1.5;
      border-radius: 0.25rem;
    }

    .btn-action-button {
      text-transform: lowercase;
      font-size: 11px !important;
      border-radius: 7px !important;
      color: white !important;
      padding: 4px 5px !important;
      background-color: #1d2643 !important;
    }

    .action-buttons {
      position: absolute;
      bottom: 10px;
      right: 35px;
    }

    .svg-chart-container:before {
      content: '';
      position: absolute;
      left: 0;
      right: 0;
      top: 0;
      bottom: 0;
      background: radial-gradient(circle at center, #04192b 0, #000b0e 100%);
    }
  </style>

  <div class="action-buttons">
    <button
      onclick='chart.setExpanded("O-6164").render()'
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="fas fa-chevron-down"></i> Expand
    </button>
    <br />

    <button
      onclick='chart.setExpanded("O-6164",false).render()'
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="fas fa-chevron-up"></i> Collapse</button
    ><br />

    <button
      onclick='chart.addNode({imageUrl:"https:\/\/raw.githubusercontent.com/bumbeishvili/Assets/master/Projects/D3/Organization%20Chart/cto.jpg",id:"root child",parentId:"O-6066",name:"test",progress:[25,20,15,10]})'
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="fas fa-folder-plus"></i> Add Node
    </button>
    <br />

    <button
      onclick='chart.removeNode("O-6067")'
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="fas fa-user-times"></i> remove</button
    ><br />

    <button
      onclick="chart.fit()"
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="fas fa-sync"></i> fit
    </button>
    <br />

    <button
      onclick='chart.layout(["right","bottom","left","top"][index++%4]).render().fit()'
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="fas fa-retweet"></i> swap
    </button>
    <br />

    <button
      onclick="chart.compact(!!(compact++%2)).render().fit()"
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="fas fa-sitemap"></i> compact
    </button>
    <br />

    <button
      onclick="chart.setActiveNodeCentered(!!(actNdCent++%2)).render()"
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="fas fa-border-none"></i> center Active
    </button>
    <br />

    <button
      onclick='chart.setCentered("O-6162").render()'
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="fas fa-compress-arrows-alt"></i> center
    </button>
    <br />
    <button
      onclick='chart.setHighlighted("O-6162").render()'
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="fas fa-highlighter"></i> mark</button
    ><br />
    <button
      onclick='chart.setUpToTheRootHighlighted("O-6162").render().fit()'
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="fas fa-route"></i> mark root
    </button>
    <br />
    <button
      onclick="chart.clearHighlighting()"
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="fas fa-eraser"></i> clear mark
    </button>
    <br />
    <button
      onclick="chart.fullscreen('body')"
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="fas fa-expand"></i> fullscreen</button
    ><br />

    <button
      onclick="chart.exportImg()"
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="far fa-images"></i> export img
    </button>
    <br />

    <button
      onclick="chart.exportImg({full:true})"
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="far fa-images"></i> export full img
    </button>
    <br />

    <button
      onclick="chart.exportSvg()"
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="fas fa-file-download"></i> export svg
    </button>
    <br />
    <button
      onclick="chart.expandAll()"
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="fas fa-angle-double-down"></i> expand all</button
    ><br />

    <button
      onclick="chart.collapseAll()"
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="fas fa-angle-double-up"></i> collapse all</button
    ><br />

    <button
      onclick="downloadPdf()"
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="far fa-file-pdf"></i> export pdf
    </button>
    <br />

    <button
      onclick='chart.connections([{from:"O-6069",to:"O-6070",label:"Conflicts of interest"}]).render()'
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="fas fa-project-diagram"></i> add link
    </button>
    <br />

    <button
      onclick="chart.zoomOut()"
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="fas fa-minus"></i> zoom out</button
    ><br />
    <button
      onclick="chart.zoomIn()"
      class="btn btn-action-button waves-effect waves-light"
    >
      <i class="fas fa-plus"></i> zoom in
    </button>
    <br />
  </div>

  <script src="https://storage.ko-fi.com/cdn/scripts/overlay-widget.js"></script>

</html>
